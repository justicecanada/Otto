{% load i18n %}
{% if documents %}
  <form id="documentsForm" method="post">
    {% csrf_token %}
 
    <table class="table">
      <thead>
        <tr>
          <th style="width: 40px;"></th>
          <th>{% trans "Document Name" %}</th>
          <th style="width: 100px;">{% trans "Date" %}</th>
          <th style="width: 120px;">{% trans "Actions" %}</th>
 
 
 
        </tr>
      </thead>
      <tbody id="sortable">
        {% for document in documents %}
          <tr data-id="{{ document.id }}"
              data-delete-url="{% url 'case_prep:delete_document' %}">
            <td class="drag-handle">&#9776;</td>
            <td>
              <!--Editable field-->
              <div class="d-flex align-items-center">
                <!-- <textarea rows="1" class="form-control document-name-input" style="resize: vertical; width: auto; flex-grow: 1">{{ document.name }}</textarea> -->
                <div class="document-name-box"
                     data-bs-toggle="modal"
                     data-bs-target="#documentDetailsModal"
                     data-document-id="{{ document.id }}"
                     data-document-name="{{ document.name }}"
                     data-document-date="{{ document.date }}"
                     data-document-original-name="{{ document.original_name }}"
                     style="resize: vertical;
                            width: auto;
                            flex-grow: 1;
                            border:1px solid #ced4da;
                            padding: 0.375rem 0.75rem;
                            border-radius: 0.25rem;
                            cursor: pointer">{{ document.name }}</div>
              </div>
              <small class="text-muted ms-2">Original: {{ document.original_name }}</small>
            </td>
            <td class="text-nowrap">
              <input type="date"
                     class="form-control"
                     value="{{ document.date|date:'Y-m-d' }}">
            </td>
            <!--<a href="{% url 'case_prep:download_document' document.id %}" class="btn btn-outline-primary" title="{% trans 'Download Document' %}">
                      <i class="bi bi-download"></i> 
                    </a>-->
            <td>
              <a href="{% url 'case_prep:toggle_document_visibility' %}"
                 class="btn btn-outline-secondary"
                 title="{% trans 'Toggle Document' %}">
                <i class="bi bi-eye"></i>
              </a>
              <!--<button type="submit" class="btn document-delete-button bi bi-trash" formaction="{% url 'case_prep:delete_document' %}" title="{% trans 'Delete Selected' %}">
                      <i class="bi bi-trash"></i>
                    </button>-->
              <a href="{% url 'case_prep:delete_document' %}"
                 class="btn btn-outline-danger document-delete-button"
                 title="{% trans 'Delete Document' %}">
                <i class="bi bi-trash"></i> <!-- Preview icon -->
              </a>
 
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </form>

 

  <!-- Document Details Modal -->
  <div class="modal fade"
       id="documentDetailsModal{{ document.id }}"
       tabindex="-1"
       aria-labelledby="documentDetailsModalLabel"
       aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="documentDetailsModalLabel">{% trans "Document Details" %}</h5>
          <button type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="{% trans 'Close' %}"></button>
        </div>
        <div class="modal-body">
          <form id="documentDetailsForm">
            <div class="mb-3">
              <label for="documentName" class="form-label">
                <strong>{% trans "Name of the document" %}</strong>
              </label>
              <input type="text"
                     class="form-control"
                     id="documentName"
                     name="documentName"
                     value="">
            </div>
            <div class="mb-3">
              <label for="documentDate" class="form-label">
                <strong>{% trans "Date" %}</strong>
              </label>
              <input type="date"
                     class="form-control"
                     id="documentDate"
                     name="documentDate"
                     value="">
            </div>
            <div class="d-flex justify-content-between">
              <label for="summary" class="form-label me-2">
                <strong>{% trans "Summary:" %}</strong>
              </label>
              <div class="mb-3 flex-fill me-2">
                <select class="form-select" id="summaryLength" name="summaryLength">
                  <option value="short">{% trans "Short" %}</option>
                  <option value="medium">{% trans "Medium" %}</option>
                  <option value="long">{% trans "Long" %}</option>
                </select>
              </div>
              <div class="flex-fill me-2">
                <select class="form-select" id="summaryLanguage" name="summaryLanguage">
                  <option value="english">{% trans "English" %}</option>
                  <option value="french">{% trans "French" %}</option>
                </select>
              </div>
              <button type="button"
                      class="btn btn-primary mb-3"
                      id="generateSummaryButton"
                      data-document-id="{{ document.id }}">{% trans "Generate" %}</button>
            </div>
            <div class="mb-3 d-flex">
              <textarea class="form-control" id="summaryOutput" rows="4"></textarea>
            </div>

            <div class="d-flex justify-content-between">
              <label for="translate" class="form-label me-2">
                <strong>{% trans "Translate:" %}</strong>
              </label>
              <div class="mb-3 flex-fill me-2">
                <select class="form-select" id="translateLanguage" name="translateLanguage">
                  <option value="english">{% trans "English" %}</option>
                  <option value="french">{% trans "French" %}</option>
                </select>
              </div>
              <button type="button" class="btn btn-primary mb-3" id="translateButton">{% trans "Translate" %}</button>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <!-- Save Button -->
          <button id="saveButton"
                  class="btn btn-success mt-2"
                  data-save-url="{% url 'case_prep:save_changes' %}">{% trans "Save Changes" %}</button>
          <button type="button" class="btn btn-primary" id="downloadButton">{% trans "Download" %}</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans "Close" %}</button>
 
 
 
        </div>
      </div>
    </div>
  </div>
{% endif %}
